pipeline {
  agent any

  options { ansiColor('xterm') }

  stages {
    stage('Do work') {
      steps {
        echo 'Hello'
      }
    }
  }

  post {
    always {
      echo '[TEST] Entering post/always...'
      emailext(
        subject: "[TEST] ${env.JOB_NAME} #${env.BUILD_NUMBER} - ${currentBuild.currentResult}",
        to: 'yourname+alerts@gmail.com',   // change to your recipient
        from: 'yourgmail@gmail.com',       // same Gmail you created App Password for
        body: """
        <h3>Post always fired âœ…</h3>
        <p>Result: ${currentBuild.currentResult}</p>
        <p>Build: <a href="${env.BUILD_URL}">${env.BUILD_URL}</a></p>
        """,
        mimeType: 'text/html',
        attachLog: true
      )
      echo '[TEST] emailext invoked.'
    }
  }
}

